<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Squash Booking MVP{% endblock %}</title>
  <style>
    :root {
      --text:#111;
      --muted:#666;
      --border:#ddd;
      --bg:#fff;
      --primary:#111;
      --primary-contrast:#fff;
      --ok:#16a34a1a;     /* soft green bg */
      --warn:#f59e0b1a;   /* soft amber bg */
      --bad:#ef44441a;    /* soft red bg */
      --ok-border:#16a34a;
      --warn-border:#f59e0b;
      --bad-border:#ef4444;
      --link:#0366d6;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 2rem;
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
    }

    header { display: flex; gap: 1.25rem; align-items: baseline; flex-wrap: wrap; margin-bottom: 1rem; }
    header h2 { margin: 0; font-size: 1.25rem; }
    nav { display: flex; gap: .75rem; align-items: center; flex-wrap: wrap; }
    .nav-link { text-decoration: none; color: var(--link); padding: .25rem .4rem; border-radius: 6px; }
    .nav-link.active { background: #e5e7eb; color: #111; }

    .pill { padding: .2rem .5rem; border-radius: 999px; background: #eee; font-size: .85rem; }
    .ok { background: #d1fae5; }
    .warn { background: #fef3c7; }
    .bad { background: #fee2e2; }
    .muted { color: var(--muted); }

    .btn {
      display: inline-block; padding: .5rem .8rem; border-radius: 8px;
      border: 1px solid #ccc; text-decoration: none; color: inherit;
      background: #f9fafb;
    }
    .btn.primary { background: var(--primary); color: var(--primary-contrast); border-color: var(--primary); }
    .btn.danger  { background: #b91c1c; color: white; border-color: #b91c1c; }
    .btn.link    { border-color: transparent; background: transparent; color: var(--link); }

    .grid { display: grid; gap: .75rem; }
    .row { display: grid; grid-template-columns: repeat(4, 1fr); gap: .5rem; }
    .card { border: 1px solid var(--border); border-radius: 10px; padding: 1rem; }

    /* Flash messages */
    .flash { list-style: none; padding: 0; margin: 0 0 1rem 0; }
    .flash-item {
      border: 1px solid var(--border);
      background: #f8fafc;
      padding: .6rem .8rem;
      border-radius: 8px;
      margin-bottom: .5rem;
    }
    .flash-item.success { background: var(--ok); border-color: var(--ok-border); }
    .flash-item.info    { background: var(--warn); border-color: var(--warn-border); }
    .flash-item.warning { background: var(--warn); border-color: var(--warn-border); }
    .flash-item.error   { background: var(--bad); border-color: var(--bad-border); }
    .flash-item.message { /* default category */ }

    main { margin-top: 1rem; }
  </style>
</head>
<body>
  <header>
    <h2>Squash Roma Booking Proto</h2>
    {% set ep = request.endpoint %}
    <nav>
      <a class="nav-link {{ 'active' if ep == 'home' else '' }}" href="{{ url_for('home') }}">Home</a>
      <a class="nav-link {{ 'active' if ep == 'new_request' else '' }}" href="{{ url_for('new_request') }}">New Request</a>
      <a class="nav-link {{ 'active' if ep == 'admin_dashboard' else '' }}" href="{{ url_for('admin_dashboard') }}">Admin</a>
      <a class="nav-link {{ 'active' if ep in ['calendar_day', 'edit_booking'] else '' }}" href="{{ url_for('calendar_day') }}">Court Bookings Calendar</a>

      {% if session.get('is_admin') %}
        <span class="pill ok">Admin</span>
        <a class="btn" href="{{ url_for('admin_logout') }}">Logout</a>
      {% else %}
        <a class="btn" href="{{ url_for('admin_login', next=request.path) }}">Admin Login</a>
      {% endif %}
    </nav>
  </header>

  {# Flash messages with categories (Flask assigns 'message' if none provided) #}
  {% with msgs = get_flashed_messages(with_categories=True) %}
    {% if msgs %}
      <ul class="flash">
        {% for category, message in msgs %}
          <li class="flash-item {{ category|lower }}">{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  {% endwith %}

  <main>
    {% block content %}{% endblock %}
  </main>
</body>
</html>